#+TITLE: Git Record Merge
ğŸš€ ğŸ¥ ğŸ¾ ğŸª€ ğŸ¥ ğŸ¥Š ğŸ¯ ğŸ¦  ğŸŒˆï¸
* music 
** [[https://www.youtube.com/watch?v=zvkHSDO5VQ8][ä¸ƒé‡Œé¦™]] 
* ğŸŒˆï¸ code snipets
** example
#+BEGIN_SRC python :results output 
from datetime import datetime
import sys

def abc(name): 
    print('hello {}'.format(name))

abc('xiao')
print(datetime.now())
print(sys.version_info)
#+END_SRC

#+RESULTS:
: hello xiao
: 2020-05-01 11:28:47.270706
: sys.version_info(major=3, minor=7, micro=7, releaselevel='final', serial=0)

** upload picture use base64
#+BEGIN_SRC python
import base64
from django.core.files.base import ContentFile
from enrichment.models import KlassSchedule

klass_schedule = KlassSchedule()
covers = cover.split(',')
content_name = covers[0].split(';')[0]
cover_name = 'cover.{}'.format(content_name.split('/')[-1])
cover_file = ContentFile(base64.b64decode(covers[1]))
klass_schedule.cover.save(cover_name, cover_file, False)

#+END_SRC

** export csv
#+BEGIN_SRC python

url(r'^withdrawn/xls/$', withdrawn_xls, name='withdrawn-xls'),

from enrichment.csv_tools import Echo, Unicodewriter
import codecs

@login_required
def withdrawn_xls(request):
    today = get_current_date()
    date_from = try_get_date(request.GET, 'date_from', '%d-%m-%Y', get_start_of_month(today))
    date_to = try_get_date(request.GET, 'date_to', '%d-%m-%Y', get_end_of_month(today))
    enrichment_center = get_center_for_user(request.user)
    students = Student.objects.filter(leave_date__isnull=False, enrichment_center=enrichment_center,
                                      leave_date__range=(date_from, date_to)).order_by('-leave_date').distinct()
    csv_data = []
    title_list = [
        'ID',
        'Child Name',
        'Gender',
        'Date Of Birth',
        'Emergency Contact',
        'Emergency Contact No.',
        'Source',
        'Class',
        'Left / Total',
        'Status',
        'Withdrawn Date',
    ]

    today = get_current_date()
    csv_data.append(title_list)
    for student in students:
        student_status = ''
        if student.leave_date and student.leave_date < today:
            student_status = _('Withdrawn')
        elif student.leave_date and student.leave_date >= today:
            student_status = _('Pre-withdrawn')
        student_id = student.pk
        student_name = student.fullname
        gender = student.get_gender_display()
        birth = student.date_of_birth.__format__('%d-%m-%Y')
        contact = student.emergency_contact
        contact_no = student.emergency_contact_no
        source = student.get_source_display()
        cls = student.get_klassschedules_name()
        left_total = '{}/{}'.format(student.left_lessons,student.total_lessons)
        withdrawn_date = student.leave_date
        tmp_data = [student_id,student_name,gender,birth,contact,contact_no,source,cls,left_total,student_status,withdrawn_date]
        csv_data.append(tmp_data)
    echoer = Echo()
    writer = UnicodeWriter(echoer)

    def csv_itertor():
        yield codecs.BOM_UTF8
        for column in csv_data:
            yield writer.writerow(column)
    a = (tmp for tmp in csv_itertor())
    response = StreamingHttpResponse(
        a,
        content_type="application/octet-stream"
    )
    response['Content-Disposition'] = 'attachment;filename="{}"'.format("withdrawn.csv")
    return response

#+END_SRC
** push notification to phone use celery
*** def push_broadcast_schedule_notify(broadcast_schedule_id, message):
** raise exception to show line number
#+BEGIN_SRC python
import traceback

traceback.print_exc()

#+END_SRC
** orm
*** orm æ‰¹é‡åˆ›å»º bulk_create()

Happening.objects.bulk_create(happening_list, batch_size=10)
+ batch_size æ§åˆ¶æ¯æ‰¹æ•°é‡
  
*** delete many to many fields
# è¿™ç§æ–¹æ³•åªé€‚ç”¨äº many to many å…³ç³»ï¼Œå¹¶ä¸” through ä½¿ç”¨çš„æ˜¯è‡ªå·±æŒ‡å®šçš„ model ä¸­é—´è¡¨
annoncement.students.clear()
*** delete related_foreighing key
klass_schedule.klassschedule_times.all().delete()

*** update
[[https://juejin.im/post/5b588b656fb9a04fba6e8681][é“¾æ¥]]
# json æ›´æ–°  
1. æ–¹æ³• 1
    data = {'username':'nick','is_active':'0'}
    User.objects.filter(id=1).update(**data)   # ä¸èƒ½æ›´æ–° auto now å­—æ®µ
2. 2
   #+BEGIN_SRC python
    data = {'username':'nick','is_active':'0'}
    _t = User.objects.get(id=1)
    _t.__dict__.update(**data)
    _t.save() 

   #+END_SRC

** remove csrf
å…³é—­ é‡å¯ç”Ÿæ•ˆ
1. in APIView:
   from django.utils.decorators import method_decorator
   from django.views.decorators.csrf import csrf_exempt

   class TestView(APIView):

       @method_decorator(csrf_exempt)
       def post(self, request):
           pass
2. from braces.views import CsrfExemptMixin

** txt ä¹±ç 
#+BEGIN_SRC python :results output
# SB Windows ç”¨çš„GBKç¼–ç æ ¼å¼
with open('path', 'rb') as f:
    contents = f.read()
    print(contents.decode('GBK'))

#+END_SRC

** url è§£æ reverse
from django.core.urlresolvers import reverse

url = reverse('kiple:kiple-callback')


** Taidii code
*** convert pic to pdf api
å‘ç”Ÿåœ¨æœåŠ¡å™¨è½¬æ¢å®Œæˆå å›è°ƒ taidii çš„æœåŠ¡å™¨
**** def handler_convert_app(app_name, upload_status=0, *args):
*** image upload
**** qiniu
/api/photo/image_upload_v2/    è·å–ä¸ƒç‰›è¿” token
def qiniu_callback()

*** è·å– user role name ä»¥åˆ¤æ–­æ˜¯ teacher or principal or guradian
#+BEGIN_SRC python
from taidiiuser.models improt TidiiUser

role_name = TaidiiUser.get_taidii_user_property(request.user, 'role_name')
center = TaidiiUser.get_taidii_user_property(request.user, 'center')

#+END_SRC

#+RESULTS:

*** enrichemt é€šè¿‡ klassschedule è·å–å­¦ç”Ÿ
#+BEGIN_SRC python
klass_schedule = list(KlassSchedule.objects.filter(Q(date_to=None)|Q(date_to__gte=today), 
                                date_from__lte=today, center=happening.center).values_list('id', flat=True).distinct())
sk_schedule = list(StudentKlassSchedule.objects.filter(Q(end_date=None)|Q(end_date__gte=today), enroll_date__lte=today, 
                            klassschedule__in=klass_schedule).values_list('id', flat=True).distinct())
students = Student.objects.filter(student_klassschedules__in=sk_schedule).distinct()

# å¦ä¸€ç§
student_classes = StudentClass.objects.filter(Q(student__leave_date__isnull=True) | Q(student__leave_date__gte=today),
                        klass__in=classes, student__enter_date__lte=today) \
                    .exclude(Q(student__enrollment_form__status__in=(0, 1, 4, 6)) | \
                        Q(student__enrollment_form__status=5, student__student_graduation__graduation_date__lt=today)) \
                    .values("student__fullname", "student__id", "klass__name", "klass__id").distinct()

#+END_SRC
*** æ‹¼æ¥ photo url é€‚é…ä¸ƒç‰›æˆ–äºšé©¬é€Š get_photo_url
from gallery.helper import get_photo_url
*** celery
celery å®šæ—¶ä»»åŠ¡ï¼š beat
å¼‚æ­¥ä»»åŠ¡ï¼š worker

**** å‘½ä»¤
celery -A taidii purge  
celery -A taidii worker -l debug
celery beat -A taidii -l debug
**** [[https://www.jianshu.com/p/a556cac5bf7d][ä¸­æ–‡æ–‡æ¡£]]
**** æŠ€å·§è®°å½•
+ task å‚æ•°
    #+BEGIN_SRC python
    @task(bind=True)
    def do_job(self, path):
        cache.set(self.request.id, operation_results)

    # æŒ‡å®šbind=True æ—¶,æœ‰ self å‚æ•°ï¼Œ self.request.id å°±æ˜¯å½“å‰ task çš„id

    # ç»“æŸä»»åŠ¡ ä½¿ç”¨
    # celery-task-tigger
    # app.control.revoke('task_id')

    # celery 3.1
    >>> from proj.celery import app
    >>> app.control.revoke(task_id)

    from celery.task.control import revoke
    revoke(task_id, terminate=True)

    #+END_SRC
+ add.apply_async() å‚æ•°
  http://docs.jinkan.org/docs/celery/userguide/calling.html#eta-and-countdown
  ETA and countdown

  expires=60 å…è®¸ç­‰å¾…æœ€å¤§æ—¶é•¿
*** sql é€Ÿåº¦ bar
    # from django.shortcuts import render
    # template_name = 'accounts/login.html'
    # return render(request, template_name, {})

* ğŸŒˆï¸ ç†è§£
** å¯¹ GenerateViewset çš„ç†è§£
action åŠ åˆ†é¡µ paginate
#+BEGIN_SRC python

page = self.paginate_queryset(instances)
if page is not None:
    return Response(StudentAssignmentSerializer(page, many=True).data)
return Response(StudentAssignmentSerializer(instances, many=True).data)

#+END_SRC
** å¯¹ serializer çš„ç†è§£
å‚æ•°ï¼š
Serializer(instance, data={}, files=request.FILES, partial=True)
- æ²¡æœ‰å®ä¾‹ å°±æ˜¯åˆ›å»º
- partial å…è®¸éƒ¨åˆ†æ›´æ–°
serializer = Serializer()
vaid = serializer.is_valid()   
if vaid:
    serializer.save()
    data = serializer.data # serializer.validated_data
else:
    err = serializer.errors
# ä¿å­˜
serializer.save()
# ä¿å­˜é¢å¤–å‚æ•°
serializer.save(owner=request.user)

    
* ğŸ¥ pull request record
** hq happenings
*** https://github.com/Taidii/taidiiv2/pull/7161
** online teaching
*** https://github.com/Taidii/taidiiv2/pull/7208/commits

** feature/zoomintegration
** feature/myobChanges_992  			dev: âœ…
myob å¯¼å‡ºæ”¹åŠ¨
** feature/merchandise_translate_1021
- [Enrichment] ç¿»è¯‘ [Mentalmatics] è·¯å¾„ï¼šResource Management - Merchandise Management(ç¿»è¯‘ä¸Šä¸€é¡µ ä¸‹ä¸€é¡µ)
- dev: âœ…
** feature/enrichmentFinanceAddRefundList_974  ğŸ“
- dev: âœ…
*** DONE è¿˜éœ€è¦åŠ ä¸ª refund å·ç  æ²¡åš
*** DONE void åŠŸèƒ½
*** DONE refund no. ä¸æ˜¾ç¤º
*** 
*** [?] credit no æ˜¾ç¤ºæœ‰é—®é¢˜ï¼Ÿï¼Ÿ
** feature/studentAttendanceAddRemarks_994 
*** dev: âœ…
*** æœºæ„ Student Attendance æ¨¡å—ä¸­ï¼Œåœ¨ Remarks æ å’Œ Action æ ä¸­é—´åŠ å…¥æ–°çš„ä¸€æ ï¼Œå«åš Additional Remarksï¼Œ å¯ä»¥è¿›è¡Œä¿®æ”¹
*** æ›´æ–° ä½¿ç”¨ js + form æ¨¡ç‰ˆ + ajax é€šä¿¡  é‡å®šå‘ url  location.search
** feature/physicalTestTranslation   dev_cn: âœ…
*** åŸºæœ¬é—®é¢˜
- éœ€è¦æƒé™ physical å¼€å¤´
- éœ€è¦ dev.cn database   è´¦å·ï¼šdemo china_cn
- è‹±æ–‡æ’ç‰ˆæœ‰é—®é¢˜
- [[http://localhost:8000/physicaltest-report/overall/analysis/]]
*** æŠ€å·§è®°å½•
#+BEGIN_SRC python
from django.utils import translation

# è·å–å½“å‰è¯­è¨€
translation.get_language()

# æ¿€æ´»æŸç§è¯­è¨€çš„ç¿»è¯‘
user_language = "en_US"
translation.activate(user_language)

# éœ€å›½é™…åŒ–çš„ä»£ç ç”¨è¿™ä¸ªï¼Œ html ç”¨ trans åŒ…è£¹ï¼Œ js ç”¨ gettext()
from django.utils.translation import ugettext_lazy as _

#+END_SRC
*** database é‡Œé¢çš„ç¿»è¯‘ï¼š 
**** physicaltest_physicalcategory
| name          | eng                                         | measure |
|---------------+---------------------------------------------+---------|
| "èº«é«˜"        | "Height",                                   |         |
| "ä½“é‡"        | "Weight"                                    |         |
| "ç«‹å®šè·³è¿œ"    | "Standing Long Jump",                       |         |
| "ç½‘çƒæŠ›æ·"    | "Tennis Ball ThrowStanding Long Jump",      |         |
| "10 ç±³æŠ˜è¿”è·‘" | "10-meter Shuttle Run",                     |         |
| "åä½ä½“å‰å±ˆ"  | "Sitting Body Flexion10-meter Shuttle Run", |         |
| "å¹³è¡¡æœ¨"      | "Balance Beam",                             |         |
| "åŒè„šè¿ç»­è·³"  | "Skip Jump",                                |         |
**** physicaltest_guardiansuggestion 
- ç©ºçš„
**** physicaltest_InterventionPlan 
*** report pdf url
- physicaltest.views.student_report_pdf(
- student_report_for_print(       /è¿™ä¸ªå°±æ˜¯å¯¼å‡º html çš„æ¨¡ç‰ˆ/
- http://localhost:8000/physicaltest-report/student_report_for_print/87661/267/

** feature/myobChanges    ğŸŒˆï¸update  dev: âœ…
** feature/edg_feature      æ–°çš„ edg åˆå¹¶åˆ° master åçš„ 
*** old branch
feature/new_EDG_task
**** feature/1783_zpj_hq_calendar    hq å¢åŠ  event  è¿™ä¸ªå¯ä»¥ç”¨ âœ…
**** feature/1784_stock_page
**** feature/XQ_1564_block_close_date   æ¢è¯¾/è¡¥è¯¾æ—¶ï¼Œå±è”½å­¦æ ¡å…³é—­çš„æ—¥æœŸ

*** TODO resource management enrichment æƒé™æœ‰é—®é¢˜
- æœ¬åœ°æ²¡æœ‰æƒé™ä¹Ÿå¯ä»¥è®¿é—® setting  ï¼Œæœªå‘ç°é—®é¢˜
*** ä¸€å¼  excel è¡¨æ ¼éœ€è¦åš 
**** TODO grading exam å·¦è¾¹æ ‡ç­¾ä¸æ˜¾ç¤º
**** TODO hq æ—¥å†æƒé™

*** migration file record 
- finance/migrations/0067_auto__add_field_centerfinance_bold.py
- resourcemanagement/migrations/0021_auto__add_packagehistory__add_package__add_itempackage.py
- students/migrations/0025_auto__add_field_student_referral.py  
** feature/hq_discountCreateChanges_1041  dev: âœ…
SCHEDULED: <2020-03-22 Sun 14:00>
- [Finance] ç»Ÿä¸€ HQ ä¸ Centre çš„åˆ›å»º Discount é¡µé¢[GEH]
** feature/estore     ï¸ğŸš€ ğŸ¯ ğŸ¦   benny use GenericViewSet
** feature/hq_happenings      hq åˆ‡æ¢å­¦æ ¡æ˜¾ç¤ºæ•°æ® (ğŸ¯ celery async)
- æ–°å¢ hq_happenings & annoncement
- create update æ¥å£æ›´æ–°
- ä¹‹å‰çš„å­¦æ ¡ä¸èƒ½ç­›é€‰å‡ºæ¥å½“å‰ hq create çš„æ•°æ®
*** api æ¥å£
åˆ›å»º happenings   /happenings/center/create/    	happenings.views.HappeningCreateView
åˆ›å»º annoucement  /announcement/create/         announcement.views.AnnouncementCreateView

*** DONE ä¸å½±å“ä¹‹å‰æ•°æ®
*** permission record
- {% if user|hq_has_permission:'happenings' or user|hq_has_permission:'announcement' or user|hq_has_permission:'survey' %}
- app_name = 'happenings'
  permission_name = 'manage'
  
*** summary

**** upload file convert åå›è°ƒä¿å­˜é—®é¢˜
taidii/convert/views.py
def save2happening(center_id, db_name, db_id, file_url, image_list, upload_status=Happening.ING):
** feature/diilearn
** feature/hq_enrichment_report_1105
*** æƒé™
 is_hq_permission_enable
enrolment:enrolment_student_report
** feature/mindStretcher_multipleLoginForTeacher_1143
+ æ­¥éª¤ï¼š
  1. ç™»å½•æ—¶çŸ¥é“ å¯ä»¥åˆ‡æ¢å¤šæœºæ„è´¦å·
  2. æ–° APIï¼Œ åˆ‡æ¢æœºæ„æ—¶ï¼Œè¿”å›é‚£ä¸ªå­¦æ ¡çš„ token
*** DONE æ¶ˆæ¯æ¨é€
Commbook and happenings announcement
  
*** KILL center.logo.url  ä¸å®‰å…¨
hq å‘ teacher announcement
å¤šæœºæ„ å®Œç¾ è‡ªåŠ¨è·³è½¬
*** DONE è¿é” teacher å‘æ¶ˆæ¯æ ‡è®° center name

** feature/financeDiscountScript_1134
ç”¨ admin è´¦å·ç™»å½•åå° èƒ½çœ‹åˆ° script æ 
*** api
/backendmanageplatform/script/searchcenterfromid/	backendmanage.views.SearchCenterFromId	backendmanage:search-center-from-id
http://localhost:8000/backendmanageplatform/script/copycenterpermission/
CalculateDiscountAPI
*** DONE åˆ·å›è„šæœ¬
** kiple epayment
*** æ€è·¯
**** è¯·æ±‚ æ”¯ä»˜ apiï¼Œ åŒ…å«å¤„ç†è¿”å›å€¼
**** å›è°ƒ api, å¼‚æ­¥è°ƒç”¨
***** ä¼šè¿›è¡Œ 6 æ¬¡ calbackï¼Œ å¦‚æœæ”¶åˆ°è¿”å› 200 è¯·æ±‚åˆ™åœæ­¢ callback
**** å­—æ®µè®°å½•
***** ç”±æˆ‘ä»¬ç”Ÿæˆçš„æ ‡è®°å­—æ®µ(è¯·æ±‚å¸¦ä¸Šï¼Œkaple åå›ç»™æˆ‘ä»¬çš„æ—¶å€™ç”¨)
ord_mercID          é…ç½®é‡Œé¢çš„ id
ord_mercref         order ref   ç”¨æ¥æ ‡è®°è´§ç‰©
ord_totalamt        order total  
***** è¯·æ±‚å¿…é¡»å­—æ®µ
ord_date
ord_totalamt
ord_gstamt   0.00   ï¼ˆè¯·æ±‚ä¸åŒï¼‰
ord_shipname
ord_mercref             Order Ref
ord_mercID
ord_returnURL       è¯·æ±‚æˆåŠŸè·³è½¬å›æˆ‘ä»¬ä¹Ÿé¡µé¢
merchant_hashvalue     = "{}.{}.{}.{}".format(merchant_secret, ord_mercID, ord_mercref, ord_totalamt(å–æ¶ˆå°æ•°ç‚¹) ) 
ord_key å’Œä¸Šé¢ä¸€æ · å›è°ƒç”¨çš„ å¤šä¸€ä¸ª  returncode 

*** feature/kiple   1158   dev: âœ…
**** api è®°å½•
for finance invoice
+ financev2.rest.views get_epayment_credentials()
+ epayment.helpers get_center_epayment_name_list()

for the estore and parent center course. its different
currently it only support only OCBC Paynow  so will need to update the api and support compatibility
+ estore.rest.views.EStoreOrderViewset  get_ocbc_payment_info()

callback:
+ eghlpaymentmy.rest.views.eghl_my_callback
+ or ocbcpaynow.rest.views.ocbc_paynow_credits_notification    # for estore
        generate_ocbc_paynow_receipt()
**** é—®é¢˜
1. è¿™ä¸ªæ–¹å¼å®‰å…¨å—ï¼Ÿ ä¸­é—´äººæ”»å‡»å°±å®Œè›‹äº†å•Š
   secret ä¸­é—´äººä¸çŸ¥é“
2. é‡å¤æ”¯ä»˜çš„é—®é¢˜ï¼Œ
3. generate_receipt successlog æ²¡ç”Ÿæˆ
   

** imp/diilearnChangeClassName_1174
ã€diilearnã€‘ä»¥å‰è¡¥ä¹ æœºæ„åˆ›å»ºè¯¾ç¨‹ï¼Œå“ªæ€•æœ‰äº†å­¦ç”Ÿï¼Œè¿™ä¸ªè¯¾ç¨‹çš„åç§°è¿˜æ˜¯å¯ä»¥æ”¹çš„ï¼Œç°åœ¨æ–°å¼€å‘çš„ç›´æ’­è¯¾ç¨‹ï¼Œä¸å¯ä»¥äº†


** imp/resourceManagementAccess_1178
    åºŸå¼ƒ
** feature/saleExportFollowUp_1200
[Enrichment] Sale - Potential Customer - Follow Up ä¸­å¢åŠ å¯¼å‡ºæŒ‰é’®	
** hotfix/OnlineCourseSwitch
** imp/happeningsName_1213  master:âœ…
** feature/saleFilterLeftLession_1201  dev: âœ…   pr: âœ…
** imp/FianceStudentDefalutValue_1203  def: âœ…

** feature/GroupChartNotification_850    dev: âœ…  masterï¼š âœ…
CommbookViewSet      å•ä¸ª commbook
GroupMessagesViewSet   ç¾¤èŠ
*** æœ‰ migration éœ€è¦æ³¨æ„
*** é—®é¢˜
éœ€è¦æ’é™¤æœ¬äºº

** imp/cameraScheduleSettings_131     ğŸš€ å¯¹ serializer çš„ç†è§£   master: âœ…
*** DONE update camera æ¥å£
*** TODO camera app list api
*** è®°å½•é—®é¢˜

**** å¦‚æœ migration å‡ºé—®é¢˜
1. åˆ é™¤ cameraSettings é‡Œé¢æ‰€æœ‰å†…å®¹
2. migtation é€»è¾‘æ˜¯å…ˆåˆ é™¤è¡¨ å†æ–°å»ºè¡¨
3. æ‰€æœ‰æ•°æ®éƒ½æ²¡äº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ
** feature/nl_courseact_livecourse    parentcenter live course
*** è®°å½•
ä»¥å‰çš„ æ·»åŠ  broadcastschedule task
AddClassAjaxView
UpdateClassAjaxView
** feature/nl_courseact_livecourse  parent center online course 
** feature/safeEntry_1272   diibear è€ƒå‹¤    âš ï¸ bugï¼ ğŸ¥Š
Center Misc Settings:
    centers/settings/miscconfig.html
    centers.views.CenterMiscView()
diilight è€ƒå‹¤æ¥å£:
    /api/attendance/
    /api/student/%@/attendance_day/     StudentViewSet
model:
   StudentDailyOverview 
   StudentAttendance
 
/api/student/safe_entry/
** imp/courseactPayment   courseact ç‰¹æ®Šå­¦æ ¡è´­ä¹°
** hotfix/groupChat
** hotfix/hq_happenings_1236
share_hq_announcement
share_hq_happenings
** imp/deleteStudentFromCourse_1269
** hotfix/singleInvoice_1289   dev:âœ…
** feature/healthyForm_1294
å¥åº·ç”³æŠ¥
diibot create api: VisitorViewSet
è®¾ç½®ï¼š HealthRemarksView
** imp/pdf_14_1286
** hotfix/ADVCalculate_1333
sale/student_class/delete/
/sale/student_class/delete/	sale.views.DeleteStudentClassAjaxView
** feature/homework_1313
*** [[https://documenter.getpostman.com/view/4243392/T17KdS1m?version=latest][æ–‡æ¡£]]
*** DONE å®¶é•¿ç«¯ å¯ä»¥çœ‹åˆ°çš„è¯¾ç¨‹åˆ—è¡¨
** 1366 ğŸ””æ˜¾ç¤ºæ¶ˆæ¯ä¸ä¸€è‡´
** feature/mindstrecher_1445
teacher é”™è´¦å·åˆ‡æ¢
https://zhuanlan.zhihu.com/p/76795134
ã€Mindstretcherã€‘Same user name to multiple center  å¤šè´¦å·åˆ‡æ¢ web ç«¯
# åˆ‡æ¢ session  å¤šè´¦å·åˆ‡æ¢
sf_teacher = self.salesforce_teachers[1]
from django.contrib.auth import login
sf_teacher.user.backend = 'django.contrib.auth.backends.ModelBackend'
login(request, sf_teacher.user)
**  feature/myob_1403
    imports.views.StudentView
** hotfix/exportPDF_1405
** feature/studentProfileImport_1396
Import past student info and withdrawn students info
enrollment.models.Statistics  é€šè¿‡è¿™ä¸ªè¡¨è®°å½• å†å²æœ‰ withdraw åæ¥åˆå…¥å­¦çš„
*** æ”¹åŠ¨äº†å·¥å…·å‡½æ•°ï¼Œ æŸ¥ withdraw å­¦ç”Ÿçš„
  EnrollmentFormManager   _get_form_list
*** æ”¹åŠ¨
# def get_simple_content(self, force=False):
** feature/estorepayment_xq
ocbc dev-new  æ³¨é‡Šå†…å®¹ï¼š
    ~/Documents/taidi/taidiiv2/taidii/ocbcpaynow/rest/views.py   :96   :68

** hotfix/surveyTotalNumber_1351
SurveyViewResultView
survey/survey_result.html
/api/surveys/3681/results   SurveyViewSet  result()

** feature/exportQRcodeForTeacher_1490
[zenaco] export QR code for teacher on V2
- diilight QRcode api: api/attendance/qrcode/  teacher_guardian_qrcode

- then for the pdf export you can refer to the student qr code export
    Settings -> Class -> Select 1 Class -> Export QRcodes -> Select student -> Export Student Card / Export GGuardin Qrcodes

- ShowGuardiansQrcodeView  student view
  barcodes/guardians_qrcode.html

- generate qrcode: GenerateQrcode

- export  pdf use canvas
  export_portfolio_pdf()
  
*** tips:
ä½¿ç”¨ reportlab canvas generate QRcode
** feature/medicineAddTime_1408
å–‚è¯æ—¶é—´æç¤ºå’Œç­¾å­—
*** MedicationRequestViewsets /parent_add_requests/ 
/api/medication/medication_record/%@/show_records/
å®šæ—¶ settingsï¼š575
pushByTime()

*** TODO éœ€è¦ remove celety task code

** feature/preschoolHomework_1349
å¹¼å„¿å›­ ä½œä¸šæ¨¡å—
** imp/sale_export
ä¼˜åŒ–ä»£ç ï¼Œä¹‹å‰å¤ªå¡äº†
** feature/enroll_hisotry_1328
*** feature/enroll_hisotry_1328_new
1346
å¢åŠ é¡µé¢æ˜¾ç¤º withdraw history
reenroll student ä¼šå¢åŠ è®°å½• ä¹‹å‰çš„ç­çº§ å…¥å­¦ï¼Œç¦»æ ¡æ—¥æœŸ

** hotfix/import_student
** imp/permissionForDelete_1526
add permission: sale:delete_student
** hotfix/registration_no_1527
/sale/get_next_registration_no/   è·å–ä¸‹ä¸€ä¸ª å·ç 
/sale/student/create/
 /sale/student/enroll/  è¯•è¯¾
*** é—®é¢˜è®°å½•
1. å› ä¸º center.registration_no_current_no  è¿™ä¸ªè®°å½•æ²¡æœ‰æ›´æ–°ï¼Œæ¯æ¬¡éƒ½é éå†å­˜åœ¨å°±åŠ  1ï¼Œæ‰€ä»¥ä¼šå·ç ä¼šé‡å¤
** feature/report_VAN_1503
Export UOB VAN report
NascanGiroSetting
*** permission:
    app_name = 'finance'
    permission_name = 'nascan-girosettings'
*** model:
CenterOCBCBankGiroInfo(models.Model):

{% if user|has_permission:'finance:nascan-van-report' %}

** imp/export_attendance_1517
åœ¨ Student Attendance - Export attendance - Excel æ ¼å¼å¯¼å‡ºçš„æ‰€æœ‰ excel æŠ¥è¡¨ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª All æ ‡ç­¾é¡µï¼Œæ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿã€‚å…¶ä»–åˆ†ç­æ˜¾ç¤ºçš„ä¸æ”¹åŠ¨ã€‚
/reports/attendance/student/attendancelist/month/0/xls/       reports.views_attendance.student_monthly_attendance_list_xls
** imp/attendance_rate_export_1518
 å‡ºå‹¤ç‡æŠ¥è¡¨ä¼˜åŒ– [Nascans]
*** ğŸŒˆé¡µé¢å¢åŠ  input åŠ¨æ€æ˜¾ç¤º æ˜¯å¦æ˜¾ç¤º  input
** imp/program_type_1533
æ”¹åŠ¨ student program_type
åŒæ­¥éœ€è¦æ”¹åŠ¨çš„ï¼šmodelï¼š
help to update 
Model 
    Finance.HQLevelDiscount
    Finance.CenterItemProgramType
    Student.StudentProgramType

** hotfix/staff_private_attendance_1532
æ²¡æœ‰çš„ï¼š
url: http://localhost:8000/staffs/private/   attendance é€‰é¡¹
staffs.views.private_profile()
staffs/private_profile.html
è¿™ä¸ªæ˜¯é€šè¿‡æ¥å£è¯·æ±‚çš„
api/staff/21132/attendances/?date_from=03-08-2020&date_to=06-08-2020    staffs.rest.views.StaffProfileViewSet
æœ‰çš„ï¼š
attendance.views.teacher_list
attendance/teacher_list.html
** feature/nascans_registration_form_1387
center.custom_field_names('acknowledgement')}  CenterCustomFieldName   acknowledgement
premission:
    # registration:nascans_enrollment
    enrolment:nascans_enrollment
    
*** TODO  æ¯ä¸ªå­—æ®µæ•°æ®åº“æˆåŠŸä¿å­˜
*** TODO  acknowledgement æ˜¯å¦å¯ä»¥æ›¿æ¢
*** 1388
permission
{% if user|has_permission:'enrolment:nascans_with_primary' %}
å°‘æ•°å­¦æ ¡éœ€è¦åŠ è¿™ä¸ªæƒé™ æ¥æ˜¾ç¤º primary scholl å­—æ®µ


** æƒé™è®¾ç½® assignment nascans
DiilightAppMenu
DiilightAppModules    Nascans Assignment
** imp/gradingExam_1561
** feature/add_class_history
1346
permission:
    {% if user|has_permission:'students:view-history' %}
**  imp/myob_1541
** hotfix/enrollment_statistics
** imp/export_student_attendance_1563  dev:âœ…
æ·»åŠ  All æ ‡ç­¾åœ¨å¯¼å‡ºæŠ¥è¡¨ä¸­ [Nascans]

